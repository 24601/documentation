عنوان: "تنظيف التخزين"
metaTitle: "تنظيف التخزين"
metaDescription: "حذف التسجيلات بالجملة من قاعدة البيانات وتنظيف مساحتك التخزينية."
---
استيراد من '~/components/Aside.astro'

## تخزين التسجيل

كل تسجيل يوجد بشكل ملف ومدخل في قاعدة البيانات. OpenReplay يفرغ ما هو ضروري لإعادة التشغيل محادثة (تغييرات DOM، إحداثيات الفأرة، سجلات الطرف الثاني، نشاط الشبكة وأكثر من ذلك) إلى ملف واحد. يتم تخزين هذه الملفات افتراضيًا على النسخة الخاصة بك، لذلك يشكلون معظم مساحة التخزين.

سيتم تخزين بيانات الجلسة في قاعدة بيانات PostgreSQL إلى الأبد، ولكن بعد 180 يومًا سيتم إنهاء / حذف الملف الذي يحتوي على التسجيل عبر سياسة حياة منيو.

### تغيير سياسة الحياة الافتراضية

يمكنك تغيير سياسة الحياة الافتراضية بهذه الطريقة:

1. شغل `k9s -n db`
2. استخدم الأسهم للتنقل في القائمة والوصول إلى حاوية `minio-*`
3. اضغط على `s` للوصول إلى الخزن (التخزين الأبعادي)
4. شغل `export MINIO_ACCESS_KEY = <secretKey من / var / lib / openreplay / vars.yaml>`
5. شغل `export MINIO_SECRET_KEY = <secretKey من / var / lib / opereplay / vars.yaml>`
6. شغل `mc alias set minio http://localhost:9000 $MINIO_ACCESS_KEY $MINIO_SECRET_KEY`
7. لتنظيف التسجيلات تلقائيًا 14 يومًا بعد الإنشاء

8. استخدم `exit` للخروج من حاوية Minio
9. شغل `:quit` للخروج من سطر الأوامر Kubernetes

## التنظيف اليدوي

### قاعدة البيانات (PostgeSQL)

استخدم الاستعلام SQL أدناه إذا كنت ترغب في تنظيف البيانات من قاعدة البيانات الخاصة بك (PostgreSQL). استبدل "timestamp epoch (milliseconds)" بالتاريخ الذي سيبقى فيه التسجيلات. هذا هو حذف الحوافز، لذلك سيتم إزالة جميع التسجيلات والأحداث المرتبطة بها من قاعدة البيانات.

<Aside type="note">
**مهم:** يتم القيام بذلك على مسؤوليتك الخاصة، لذلك كن حذرًا جدًا عند تنفيذ هذه الإجراءات في قاعدة البيانات.
</Aside>
```bash
export EXPIRATION_DAYS=14
cat <<EOF > /tmp/lifecycle.json
{
    "Rules": [
        {
            "Expiration": {
                "Days": $EXPIRATION_DAYS
            },
            "ID": "${bucket}",
            "Status": "Enabled"
        }
    ]
}
EOF
mc ilm import minio/mobs < /tmp/lifecycle.json
```
