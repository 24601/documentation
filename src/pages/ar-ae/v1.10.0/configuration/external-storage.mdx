---
العنوان: "التخزين الخارجي"
metaTitle: "التخزين الخارجي"
metaDescription: "كيفية تغيير وجهة التخزين الافتراضية لحظات الجلسات الخاصة بك."
---

تتم تسجيلات OpenReplay [جلسات الجلسات](/configuration/cleanup-storage#recordingstorage) بشكل افتراضي في المثيل الخاص بك، ولكن يمكن تغيير الوجهة إلى أي خدمة تخزين الكائنات المتوافقة مع S3، مما يسمح للحصول على تطورات أكبر وتكاليف تثبيت أقل.

## تغيير وجهة تخزين التسجيلات

يمكن تخزين التسجيلات في أي وجهة تخزين الكائنات مع الشرط أنها متوافقة مع S3، مما يجعل OpenReplay متوافقًا مع جميع الخدمات السحابية الرئيسية. أدناه خطوات لتكوين وجهة مختلفة لتسجيلاتك:

### إنشاء الحزم اللازمة

يجب عليك إنشاء الحزم أدناه في خدمة تخزين الكائنات الخاصة بك. يمكن أن تكون أسماؤها مختلفة، ولكن سنستخدم المرجعيات أدناه في المرحلة المتبقية من هذا القسم:
- `openreplay-recordings`: حيث سيتم تخزين التسجيلات
- `openreplay-assets`: حيث سيتم نسخ الأصول (مثل css والخطوط)
- `openreplay-sourcemaps`: لتخزين الخرائط المصدر (انظر [كيفية تحميلها](/installation/upload-sourcemaps))

بمجرد إنشاء الحزمة:

1. قم بتمكين CORS لكل من الحزم أعلاه. إذا كنت في AWS، فسيكون ذلك تحت "الأذونات> مشاركة المصادر المتعددة الأصول (CORS)" باستخدام التكوين التالي:


```json
[
    {
        "AllowedHeaders": [
            "*"
        ],
        "AllowedMethods": [
            "GET"
        ],
        "AllowedOrigins": [
            "*"
        ],
        "ExposeHeaders": []
    }
]
```


2. قم بتمكين الوصول العام إلى حزمة `openreplay-assets` **فقط**. هذه الأخيرة تحتوي فقط على الأنماط والأيقونات والخطوط التي هي ضرورية لإعادة تشغيل الجلسة الصحيحة. إذا كنت في AWS، فانتقل أولا إلى "الأذونات> منع الوصول العام (إعدادات الحزمة)" وأوقفه، ثم انتقل إلى "الأذونات> سياسة الحزمة" واستخدم التكوين التالي:


```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "AddPerm",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::openreplay-assets/*"
        }
    ]
}
```


3. أخيرًا، تأكد من إنشاء مفاتيح الوصول المناسبة إلى **هذه الثلاث حزم فقط** حتى يتمكن OpenReplay backend من الوصول بشكل برمجي لتحميل الملفات. الأذونات S3 المطلوبة هي:


```json
"s3:PutObject",
"s3:GetObjectAcl",
"s3:GetObject",
"s3:GetObjectTagging",
"s3:ListBucket",
"s3:PutObjectTagging",
"s3:GetBucketLocation"
```


### تحديث الخدمات الخلفية

1. قم بتسجيل الدخول إلى مثيل OpenReplay الخاص بك وانتقل إلى `/var/lib/openreplay/vars.yaml` ثم حدث المتغيرات البيئية أدناه في قسم `s3`:

| المتغير | الوصف |
|----------|-------------|
| accessKey | مفتاح خدمة تخزين الكائنات الخاص بك |
| secretKey | السر الخاص بخدمة تخزين الكائنات الخاصة بك |
| endpoint | عنوان URL (بدءًا من `https`) لخدمة تخزين الكائنات الخاصة بك (على سبيل المثال، تحقق من قائمة [نقاط نهاية S3](https://docs.aws.amazon.com/general/latest/gr/s3.html) إذا كنت في AWS، وفي Google Cloud Storage هذا سيكون `https://storage.googleapis.com`) |
| region | المنطقة (إذا كان مناسبًا) لحزمك (على سبيل المثال، إذا كنت تستخدم AWS S3، فسيكون هذا شيئًا مثل `us-east-1`) |
|
```bash
openreplay -R
```
