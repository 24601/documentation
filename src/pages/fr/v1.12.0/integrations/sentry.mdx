---
titre: "Sentry"
metaTitle: "Intégration de Sentry"
metaDescription: "Comment intégrer Sentry avec OpenReplay et voir les erreurs de back-end avec les reprises de session."
---

Comment intégrer Sentry avec OpenReplay et voir les erreurs de back-end avec les enregistrements de session.

## 1. Générer un jeton d'authentification Sentry

Accédez à [Sentry > Account > API > Auth Tokens] (https://sentry.io/settings/account/api/auth-tokens/) et générez le jeton avec les autorisations `event:read`, `org:read` et `project:read`. Ce dernier sera utilisé dans l'étape suivante pour activer votre intégration Sentry dans le tableau de bord OpenReplay.

![Créer un jeton dans Sentry] (/static/sentry-1.png#center)

## 2. Activer l'intégration dans OpenReplay

Copiez votre `organization_slug` et votre `project_slug` de la page **Projects** dans votre tableau de bord Sentry.

![Page des projets dans Sentry] (/static/sentry-2.png#center)

![Formulaire d'intégration Sentry dans OpenReplay] (/static/sentry-3.png#center)

Ensuite, collez-les dans le tableau de bord OpenReplay sous «Préférences> Intégration» avec le jeton que vous avez précédemment généré à l'étape 1.

## 3. Propager openReplaySessionToken

Pour que OpenReplay associe un événement Sentry à la session utilisateur enregistrée, l'événement Sentry doit être étiqueté avec un jeton unique.

### Frontend
Si vous vous appuyez sur Sentry sur votre frontend, vous pouvez suivre l'exemple ci-dessous.


```javascript
import OpenReplay from "@openreplay/tracker";
import * as Sentry from "@sentry/browser";

const tracker = new OpenReplay({
	projectKey: MY_PROJECT_KEY,
	onStart: ({ sessionToken }) => {
	  Sentry.setTag("openReplaySessionToken", sessionToken);
	},
})
```


Ou dans le cas d'un extrait:

```javascript
if (window.OpenReplay.getSessionToken()) {
	Sentry.setTag("openReplaySessionToken", window.OpenReplay.getSessionToken());
}
```


### Backend
Sinon, si vous utilisez le SDK Sentry pour le back-end, le jeton de session doit être propagé depuis votre frontend sur chaque requête que vous souhaitez suivre. Cela peut être fait en utilisant un en-tête HTTP personnalisé. Dans l'exemple ci-dessous, nous utilisons l'API `fetch` pour envoyer cet en-tête.


```javascript
const headers = {
  Accept: 'application/json',
  'Content-Type': 'application/json',
};
if (tracker.getSessionToken()) { // or window.OpenReplay instead of tracker if you're using the snippet
  headers['X-OpenReplay-SessionToken'] = tracker.getSessionToken(); // Inject openReplaySessionToken
}
fetch('www.your-backend.com', {
  'GET',
  headers,
});
```


Vous pouvez également utiliser le [plugin Fetch] d'OpenReplay (/plugins/fetch) pour définir l'en-tête automatiquement pour chaque demande de suivi.

Ensuite, vous pouvez extraire le `openReplaySessionToken` de l'en-tête et l'ajouter à votre portée Sentry (idéalement en utilisant un middleware ou un décorateur).


```python
with configure_scope() as scope:
  scope.set_tag('openReplaySessionToken', app.current_request.headers.get('X-OpenReplay-SessionToken'))
```


Le nom de l'étiquette doit être exactement `openReplaySessionToken`.

## 4. Attacher openReplaySessionURL (facultatif mais très utile)

Si vous souhaitez lier l'URL de l'enregistrement OpenReplay à Sentry et l'afficher sous forme d'étiquette, voici un exemple de la façon de le faire:


```javascript
 const tracker = new OpenReplay({
 projectKey: window.OPENREPLAY_PROJECT_KEY,
 
 onStart: ({ sessionToken, sessionID }) => {
  // This is to link from OpenReplay -> Sentry
  Sentry.setTag("openReplaySessionToken", sessionToken);
 
  // This is to link from Sentry -> OpenReplay (requires tracker v3.6.0+)
  Sentry.setTag(
    "openReplaySessionURL",
    tracker.getSessionURL();
    );
  },
});
```

