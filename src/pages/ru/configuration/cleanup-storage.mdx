Заголовок: «Очистка хранилища»
Мета-заголовок: «Очистка хранилища»
Мета-описание: «Удалите записи в больших объемах из базы данных и очистите хранилище».

Каждая запись существует в виде файла и записи в базе данных. OpenReplay выгружает необходимое для повторного воспроизведения сеанса (мутации DOM, координаты мыши, журналы консоли, сетевая активность и многое другое) в 3 файла (2 для самого повторного воспроизведения и 1 для данных DevTools). По умолчанию эти файлы хранятся на вашем экземпляре, поэтому они составляют большую часть его хранилища. Метаданные сеанса будут храниться в базе данных PostgreSQL навсегда, но после 180 дней файл, содержащий запись, будет истекшим/удаленным через политику жизненного цикла minio.

Для очистки хранилища в вашем экземпляре OpenReplay есть 2 способа: автоматизированный (CLI) и вручную.

## Очистка данных (CLI)

Этот процесс полностью автоматизирован через наш CLI. Просто выполните нижеуказанную команду, чтобы очистить хранилище, удалив данные из обоих Postgres (где хранятся события) и minio (где хранятся записи):

## Очистка данных (вручную)

Данные можно удалять из базы данных (где хранятся события) и minio (где хранятся записи).

### Очистка записей

Если вам нужно освободить некоторое пространство, войдите в свой экземпляр OpenReplay и следуйте нижеуказанным шагам:

1. Запустите `k9s -n db`
2. Используйте клавиши со стрелками, чтобы переместиться по списку и перейти к контейнеру `minio-*`
3. Нажмите `s`, чтобы получить доступ к объектному хранилищу Minio
4. Запустите `mc alias set minio http://localhost:9000 $MINIO_ACCESS_KEY $MINIO_SECRET_KEY`
5. Запустите `mc rm --recursive --dangerous --force --older-than 7d minio/mobs` (т. е. удалите файлы, старше 7 дней)
6. Используйте `exit`, чтобы выйти из контейнера Minio
7. Запустите `:quit`, чтобы выйти из Kubernetes CLI

#### Изменение политики жизненного цикла по умолчанию

Если вы используете minio (ванильную установку), вы можете изменить политику жизненного цикла по умолчанию следующим образом:

1. Запустите `k9s -n db`
2. Используйте клавиши со стрелками,
```bash
# To clean data older than 14 days
openreplay --cleanup 14
```
